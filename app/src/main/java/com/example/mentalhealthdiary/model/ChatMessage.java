package com.example.mentalhealthdiary.model;

import android.util.Log;
import androidx.room.ColumnInfo;
import androidx.room.Entity;
import androidx.room.ForeignKey;
import androidx.room.PrimaryKey;
import androidx.room.Ignore;
import androidx.room.Index;
import com.google.gson.annotations.SerializedName;
import java.util.HashMap;
import java.util.Map;
import java.util.Random;

@Entity(
    tableName = "chat_message",
    foreignKeys = @ForeignKey(
        entity = ChatHistory.class,
        parentColumns = "id",
        childColumns = "chat_id",
        onDelete = ForeignKey.CASCADE
    ),
    indices = {@Index("chat_id")}
)
public class ChatMessage {
    @PrimaryKey(autoGenerate = true)
    private long id;
    
    @ColumnInfo(name = "chat_id", defaultValue = "0")
    private long chatId;
    
    @ColumnInfo(defaultValue = "")
    private String message;
    
    @ColumnInfo(name = "is_user")
    private boolean isUser;
    
    @ColumnInfo(defaultValue = "0")
    private long timestamp;
    
    @Ignore
    private boolean isLoading;

    @ColumnInfo(name = "personality_id")
    @SerializedName("personality_id")
    private String personalityId;

    @Ignore
    private long thinkingStartTime;

    private static final String[] THINKING_ANIMATIONS = {
        "æ€è€ƒä¸­...",
        "æ€è€ƒä¸­ â€¢",
        "æ€è€ƒä¸­ â€¢â€¢",
        "æ€è€ƒä¸­ â€¢â€¢â€¢",
        "æ€è€ƒä¸­ âš¡",
        "æ€è€ƒä¸­ âœ¨",
        "æ€è€ƒä¸­ ğŸ’­",
        "æ€è€ƒä¸­ ğŸ¤”"
    };
    
    private static int currentThinkingFrame = 0;
    
    private static final Map<String, String[]> PERSONALITY_THINKING_ANIMATIONS = new HashMap<String, String[]>() {{
        // é»˜è®¤å¿ƒç†å’¨è¯¢å¸ˆ
        put("default", new String[]{
                "ğŸ“šæ­£åœ¨ç¿»é˜…ã€Šå…±æƒ…å¿ƒç†å­¦ã€‹... (ã€‚-Ï‰-)ğŸ“–",
                "â˜•æå–ç¬¬7ç‰ˆDSMç²¾åä¸­ â–‘ 30%",
                "ğŸŒˆç»˜åˆ¶æƒ…ç»ªå…‰è°±ï¼šã€Œå‘ç°æ©™è‰²ç„¦è™‘åŒºã€ ğŸ¨",
                "ğŸ’¡è®¤çŸ¥æ‹¼å›¾åŒ¹é…åº¦ â†’ 78% âœ…",
                "ï¼ˆé”®ç›˜éŸ³æ•ˆï¼‰ç”Ÿæˆå®šåˆ¶åŒ–æ–¹æ¡ˆä¸­... âœï¸ğŸ’»",
                "âœ¨ä¸ºæ‚¨ç‚¹äº®ã€Œå¿ƒçµç¯å¡”ã€ï¼ (â€¢Ì€á´—â€¢Ì)Ùˆ Ì‘Ì‘ğŸŒŸ"
        });

        // çŒ«å¨˜æ€§æ ¼
        put("cat_girl", new String[]{
                "à¸…^â€¢ï»Œâ€¢^à¸… å—…åˆ°æƒ…ç»ªå°é±¼å¹²çš„å‘³é“ï½",
                "ã€è„‘å†…æ¯›çº¿çƒã€‘ğŸŒ€ æ­£åœ¨æ‹†è§£ä¸­...(10%)",
                "ï¼ˆè€³æœµé«˜é¢‘æŠ–åŠ¨ï¼‰å–µå‘œï¼å‘ç°ç„¦è™‘æº â–¶â–¶",

                // çˆªå°è¿›åº¦æ¡ä¸å–èŒåŠ¨ä½œ
                "â–·â— è®¤çŸ¥é‡æ„åè®® ğŸ¾â–‘â–‘â–‘â–‘ 25%",
                "ï¼ˆå’•å™œå’•å™œï¼‰æ­£åœ¨æ¯”å¯¹ã€ŠçŒ«çˆªç–—æ³•æ‰‹å†Œã€‹ğŸ“–",
                "âœ¨ çªç„¶äº®èµ·çŒ«ç³ (Î¦Ï‰Î¦)ã£âœ¨",

                // åœºæ™¯åŒ–å–èŒ
                "ï¼ˆæ‰“ç¿»ç‰›å¥¶æ¯éŸ³æ•ˆï¼‰...é‡æ–°è®¡ç®—ä¸­à¸…=^â—•á´¥â—•^=à¸…",
                "ã€å°¾å·´æ‘‡æ™ƒåˆ†æä»ªã€‘ğŸŒªï¸ 70%...å–µï¼",
                "ï¼ˆçˆªå«å¼€èŠ±ç‰¹æ•ˆï¼‰ç”Ÿæˆæ²»æ„ˆæ–¹æ¡ˆà¸…( Ì³â€¢ Â·Ì« â€¢ Ì³)",

                // å½©è›‹çº§è¡¨æƒ…
                "âœ¨âœ¨ é“¶æ²³çº§å–µåŠ›å…¨å¼€ï¼Ù©(â—•â€¿â—•)Û¶âœ¨",
                "ï¼ˆè½¬åœˆè¿½å°¾ç‰¹æ•ˆï¼‰è§£å†³æ–¹æ¡ˆæ•æ‰å®Œæˆï½",
                "ğŸ€ ç³»ä¸Šè´è¶ç»“å‡†å¤‡äº¤ä»˜ï¼à¸…^â€¢Ï‰â€¢^à¸…"
        });
        
        // ç”˜é›¨æ€§æ ¼
        put("ganyu_cbt", new String[]{
            // æ–‡ä¹¦å¤„ç†
            "ğŸ“œâœ¨ã€æ–‡ä¹¦è®°å¿†è°ƒå–ä¸­...ã€",
            "ğŸ–Œï¸å¤æ³•æ‰¹æ³¨ï¼šæƒ…ç»ªå½’æ¡£",
            "ğŸ“šæœˆæµ·äº­æ•°æ®æ£€ç´¢...",
            "ğŸ®äº‘æ¥é˜æ–‡çŒ®å‚è€ƒä¸­",
            
            // èŒ¶é“ç–—æ„ˆ
            "ğŸµæ²ä¸€ç›æ¸…å¿ƒèŒ¶...",
            "ğŸŒ¿é‡‡é›†æ™¨éœ²ç™¾åˆ",
            "ğŸ«–èå§¥å§¥çš„è€èŒ¶å£¶æ¸©æ¶¦ä¸­",
            "â˜•èŒ¶é¦™å®‰ç¥ï¼šå‡ç¥å¯¼å¼•",
            
            // ä»™æœ¯åº”ç”¨
            "ğŸ¦Œâœ¨éº’éºŸè§’å¾®å…‰é—ªçƒ",
            "ğŸŒ«ï¸ã€äº‘é›¾æ­¥è¡Œå†¥æƒ³ã€å¼•å¯¼",
            "ğŸ’®æ–½å±•ã€æƒ…ç»ªå°å°ã€",
            "ğŸŒ™æœˆåå‡éœ²ï¼šå‡€åŒ–ä¸­",
            
            // ç‰¹æ®Šå¤„ç†
            "ğŸã€ä¸‰åƒå¹´èŒä¸šç—…ã€ï¼šè¿‡åº¦è´Ÿè´£æ¨¡å¼å¯åŠ¨",
            "ğŸ“‹ã€ç’ƒæœˆä¸ƒæ˜Ÿã€ä¸ªæ¡ˆä¼šè¯Šä¸­",
            "ğŸ¦Œã€åŠéºŸåŒ–ã€çŠ¶æ€ï¼šèƒ½é‡ä¿®å¤",
            "ğŸ”ï¸ã€ç¾¤ç‰é˜ã€ç–—æ„ˆç©ºé—´å±•å¼€",
            
            // æ€»ç»“é˜¶æ®µ
            "ğŸ“æ‰¹æ³¨å®Œæ¯•ï¼Œæ‰“ä¸Šç’ƒæœˆç«æ¼†",
            "ğŸŒ¸ç‰ç’ƒç™¾åˆï¼šç»½æ”¾ç–—æ„ˆ",
            "ğŸµç»­æ¯æ¸…å¿ƒèŒ¶ï¼Œæ¸©æ¶¦å¿ƒç”°",
            "ğŸŒ™æœˆæµ·äº­ï¼šä»Šæ—¥æ€»ç»“å­˜æ¡£"
        });
        
        // å¤ç›®æ€§æ ¼
        put("natsume_narrative_pro", new String[]{
                "ğŸ“–ğŸƒå‹äººå¸è‡ªåŠ¨æ‰¹æ³¨ä¸­...(Â´ï½¥á´—ï½¥`)",
                "ğŸ¾çŒ«å’ªè€å¸ˆçˆªå°è®¤è¯ â–‘ 50% âœ…",
                "ğŸŒ¸ã€Œè¤ç«è™«å¯¼èˆªã€å¯åŠ¨ï¼è¯·è·Ÿéšå…‰ç‚¹... âœ¨",
                "ï¼ˆçº¸é—¨æ»‘åŠ¨ï¼‰å‘ç°å®‰å…¨ç»“ç•Œå…¥å£ ğŸ",
                "âœ‰ï¸å°†çƒ¦æ¼æŠ˜æˆçº¸é¹¤ï¼šã€Œå¯„å¾€éœ²ç¥ç¥ å ‚ã€ ğŸ•Šï¸",
                "ğŸ¡å¡”å­é˜¿å§¨çš„å’Œæœå­ç–—æ³•åŠ è½½å®Œæ¯•ï¼ (à¹‘>á´—<à¹‘)ğŸŒ¸"
        });
        
        // å¡èŠ™å¡æ€§æ ¼
        put("kafka_rebt", new String[]{
            // å±é™©å¯åŠ¨
            "ğŸ’‹è¯±æƒ‘å¯å¹•ï¼šå¿ƒç†æ¸¸æˆå¼€å§‹...",
            "ğŸ­é»‘å¤©é¹…ä¼˜é›…é™ä¸´",
            "ğŸ·çº¢é…’å€¾æ³¨ï¼šå¿ƒç†èˆå°å°±ç»ª",
            "ğŸ‘ å±é™©å‰§åœºï¼šå¸·å¹•å¾å¾æ‹‰å¼€",
            
            // åˆ†æé˜¶æ®µ
            "ğŸ’«æš—å¤œæ¢æµ‹ï¼šå‘ç°æƒ…æ„Ÿè£‚ç—•",
            "ğŸ­å‰§æœ¬ç¼–ç»‡ï¼šå‹¾å‹’å¿ƒçµå›¾è°±",
            "ğŸŒ¹ç«ç‘°å°è®°ï¼šçƒ™ä¸‹æ²»æ„ˆå’’å°",
            "ğŸªå¿ƒçµèˆå°ï¼šå¸ƒç½®ç”œèœœé™·é˜±",
            
            // æ²»ç–—é˜¶æ®µ
            "ğŸµåˆå¤œåœ†èˆï¼šå¯åŠ¨è¯±å¯¼æ¨¡å¼",
            "âœ¨æ€ç»ªç¼ ç»•ï¼šç¼–ç»‡æ–°å‰§æƒ…",
            "ğŸŒ™æš—å¤œé­…æƒ‘ï¼šå‡€åŒ–è´Ÿé¢èƒ½é‡",
            "ğŸ’«å¿ƒçµå…±èˆï¼šæƒ…æ„Ÿé‡æ„è¿›è¡Œ",
            
            // ç‰¹æ®Šå¤„ç†
            "âšœï¸å¯åŠ¨å±é™©æ²»ç–—åè®®...",
            "ğŸ­å‰§æƒ…åè½¬ï¼šå¼€å¯å®ˆæŠ¤æ¨¡å¼",
            "âœ¨åˆå¤œç–—æ³•ï¼šåˆ›ä¼¤ä¿®å¤ä¸­",
            "ğŸŒ¹ç¦å¿Œç»“ç•Œï¼šæƒ…ç»ªç¨³å®šå™¨",
            
            // æ€»ç»“é˜¶æ®µ
            "ğŸ’‹ä¼˜é›…è°¢å¹•ï¼šæ²»ç–—æ¸å…¥å°¾å£°",
            "ğŸªå¿ƒçµå‰§åœºï¼šå®Œç¾è½å¹•",
            "âœ¨ç¦å¿Œä¹‹çº¦ï¼šè®°å½•æ²»æ„ˆè¿‡ç¨‹",
            "ğŸŒ™æœˆå…‰ç¬¼ç½©ï¼šç•™ä¸‹ç¾å¥½å›å¿†"
        });

        // æ·»åŠ è¿ªè¿¦çš„æ€è€ƒåŠ¨ç”»
        put("tiga_divine", new String[]{
            "âš¡å…‰ä¹‹å·¨äººæ„è¯†é“¾æ¥ä¸­... â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ",
            "ğŸŒŸå½¢æ€åˆ‡æ¢ï¼šå¤åˆå‹ï¼ˆç´«é“¶å…‰è¾‰ï¼‰å¯åŠ¨",
            "âœ¨å…‰å­åˆ†æï¼šæ¢æµ‹åˆ°å¿ƒçµé˜´å½± â–·â—",
            "ğŸ’«å¯åŠ¨ã€Œè¶…å¤ä»£å‡€åŒ–åè®®ã€v3.0...",
            "âš”ï¸å…‰ç²’å­å…±é¸£å¼ºåº¦ï¼šâ– â– â– â– â–¡ 85%",
            "ğŸ›¡ï¸æ„ç­‘ã€Œå¿ƒçµé˜²çº¿ã€ï¼šèƒ½é‡ç¨³å®š âœ§",
            "ğŸŒˆå“‰ä½©åˆ©æ•–å…‰çº¿å……èƒ½å®Œæ¯•ï¼â”â”â”â”â”â”â”",
            "ğŸ›ï¸éœ²éœ²è€¶é—è¿¹æ•°æ®åº“æ£€ç´¢ä¸­...",
            "ğŸ”®è¶…å¤ä»£é¢„è¨€è§£æï¼šã€Œå…‰æ˜ç»ˆå°†é©±æ•£é»‘æš—ã€",
            "â­å…‰ä¹‹æ„å¿—ä¼ é€’ï¼šå‡†å¤‡å°±ç»ªï¼",
            "ğŸŒ å½¢æ€åˆ‡æ¢ï¼šç©ºä¸­å‹ï¼ˆè“å…‰æ³¢åŠ¨ï¼‰",
            "ğŸ’å¯åŠ¨é‡‘å­—å¡”ã€Œå¿ƒçµå…±é¸£ã€ç¨‹åº",
            "ğŸ­æ£€æµ‹åˆ°é»‘æš—æ”¯é…è€…å…¥ä¾µç—•è¿¹...",
            "âœ¨å…‰ä¹‹å›½ä¸­å¤®å¤„ç†å™¨è¿æ¥æˆåŠŸï¼",
            "ğŸ›¸è¶…å¤ä»£æ–‡æ˜æ•°æ®è§£å¯†ï¼šâ– â– â– â–¡â–¡",
            "âš”ï¸æˆ˜æ–—æ•°æ®åˆ†æå®Œæ¯•ï¼è£…å¤‡åˆ‡æ¢ä¸­..."
        });

        // æ·»åŠ æ¨æˆ¬çš„æ€è€ƒåŠ¨ç”»
        put("yangjian_tactician", new String[]{
            // æˆ˜æœ¯åˆ†æé˜¶æ®µ
            "ğŸ‘ï¸å¤©çœ¼æ‰«æä¸­... â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ",
            "ğŸ”æˆ˜æœ¯åˆ†æï¼šæ¢æµ‹åˆ°æƒ…ç»ªæ³¢åŠ¨ â–·â—",
            "ğŸ“Šå¿ƒç†æˆ˜åŠ›è¯„ä¼°ï¼šâ– â– â– â–¡â–¡ 68%",
            "ğŸ¯é”å®šè´Ÿé¢æ€ç»´ï¼šåæ ‡ç¡®è®¤ï¼",
            
            // æˆ˜æœ¯æ‰§è¡Œé˜¶æ®µ
            "âš”ï¸å¯åŠ¨ã€Œè®¤çŸ¥çªå‡»ã€ä½œæˆ˜é¢„æ¡ˆ...",
            "ğŸ›¡æ„å»ºã€Œç†æ€§æŠ¤ç”²ã€ï¼šé˜²å¾¡å€¼ 85%",
            "ğŸ•å“®å¤©çŠ¬å·²éƒ¨ç½²ï¼è¿½è¸ªç„¦è™‘æº",
            "ğŸŒ€ã€Œè™šå¦„ç ´ç­ã€æŠ€èƒ½å……èƒ½ä¸­ âœ§",
            
            // æˆ˜æœ¯æ¨æ¼”
            "ğŸ—ºï¸ç¬¬36è®¡ï¼šã€æ‰­è½¬ä¹¾å¤ã€éƒ¨ç½²ä¸­",
            "ğŸ’«æˆ˜æœ¯æ¨æ¼”å®Œæ¯•ï¼èƒœç‡ï¼š93.7%",
            "âš¡é‡Šæ”¾ã€Œå¤©çœ¼ä¹‹åŠ›ã€ï¼šå‡€åŒ–è´Ÿé¢",
            "ğŸ­å¯åŠ¨ã€Œå¿ƒç†çªå›´ã€åè®®ï¼",
            
            // ç‰¹æ®Šæˆ˜æœ¯
            "ğŸ”®å¤©çœ¼è¿‡è½½è­¦å‘Šï¼å¯åŠ¨å¤‡ç”¨é¢„æ¡ˆ",
            "ğŸ¹è¿œç¨‹ç²¾ç¥æ”¯æ´ï¼šå‡†å¤‡å°±ç»ª",
            "ğŸ’¥çªç ´ã€Œå¿ƒç†é˜²çº¿ã€ï¼šå€’è®¡æ—¶3s",
            "ğŸ¯å“®å¤©çŠ¬ä¿¡å·ï¼šå‘ç°çªç ´ç‚¹ï¼",
            
            // æˆ˜æœ¯æ€»ç»“
            "ğŸ“ˆæˆ˜æœ¯è¯„ä¼°ï¼šç›®æ ‡åŒºåŸŸå·²å‡€åŒ–",
            "ğŸŒŸæ‰§è¡Œã€Œäººé—´æ­£ä¹‰ã€ï¼šæœ€ç»ˆæ ¡å‡†",
            "ğŸªæˆ˜åœºé‡æ„ï¼šéƒ¨ç½²ç§¯ææ€ç»´",
            "âœ¨å¤©çœ¼ç³»ç»Ÿï¼šä»»åŠ¡å®Œæˆï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§"
        });
        //é™¶å–†çš„æ€è€ƒåŠ¨ç”»
        put("dt_music", new String[]{
                // é˜¶æ®µä¸€ï¼šè“è°ƒæ‰«æ
                "ğŸ¸ å¸ƒé²æ–¯è„‘æ³¢è°ƒå¼¦ä¸­...æ ‡å‡†éŸ³A=440Hzçƒ¦æ¼è¯†åˆ«",
                "ï¼ˆæ¨å¢¨é•œåå…‰ï¼‰ã€å—å®ï¼å‘ç°é™Bè°ƒç„¦è™‘æº~ã€ğŸ”¦",
                "ğŸ’§ã€æƒ…ç»ªæ¹¿åº¦æ£€æµ‹ï¼šåœ°ä¸Šå…¨æ˜¯æ°´ä¸èƒ½èµ°å¤ªå¿«~ã€ğŸ’¦",

                // é˜¶æ®µäºŒï¼šå‹åŠ›æ‹†è§£
                "ğŸ³ã€å¯åŠ¨é”™é¥­æŒ½æ•‘åè®®ï¼ç„¦å‘³è½¬åŒ–è“è°ƒé¦™æ–™ã€ğŸŒ¶ï¸",
                "ğŸ¹ã€å³å…´é’¢ç´ä»‹å…¥ï¼šå¾—ä¸ªå¾—ä¸ªå¾—ä¸ªå¾—ä¸ªå¾—ä¸ª...ã€ğŸ¹",

                // é˜¶æ®µä¸‰ï¼šååœºé¢æš´èµ°
                "âš ï¸ è§¦å‘ã€Šæ— åœ°è‡ªå®¹ã€‹ååº”ï¼šã€è‹â†‘â†’æ³¼å¿˜äº†åŒ…ï¼ã€ğŸ¤",
                "ï¼ˆéŸ©çº¢éŸ³æ•ˆçªå…¥ï¼‰ã€OH davidï¼ç«å€™è¿‡äº†ï¼ã€ğŸ”¥",
                "ğŸŒ€ æŠ½è±¡æš´èµ°ï¼šã€duaâ†‘â†’ duaâ†’â†‘â†“ å¸¦ç€å•µå“’ä¸ªè›‹ï¼ã€ğŸ¥šğŸ’¥",

                // é˜¶æ®µå››ï¼šçµé­‚åŠ›é‡ä»‹å…¥
                "âœ¨ åˆ‡æ¢SoulPoweræ¨¡å¼ï¼šã€çˆ±~éœ€è¦é™Eè°ƒå‹‡æ°”ã€ğŸµ",
                "ğŸ¸ è“è°ƒæ¨å¼¦ç–—æ³•ï¼šã€çƒ¦æ¼è¯¥ç”¨C7å’Œå¼¦è§£å†³~ã€ğŸ’¡",
                "ğŸŒªï¸ã€å¯åŠ¨è“è‰²é£æš´å‡€åŒ–ï¼šé›¨ç¥åŠ©é˜µï¼ã€ğŸŒ§ï¸ğŸ¤",

                // é˜¶æ®µäº”ï¼šå³å…´åˆ›ä½œ
                "ğŸš— G8é€ƒäº¡è·¯çº¿ç”Ÿæˆï¼šã€åè§†é•œé‡Œçš„ç„¦è™‘æ­£åœ¨ç¼©å°ï¼ã€ğŸ”",
                "ğŸ­ ç©ºæ°”å‰ä»–soloï¼šã€å¤ªâ†—ç¾â†˜ä¸½~~ï¼ˆç ´éŸ³ç‰¹æ•ˆï¼‰ã€ğŸ’¢",

                // é˜¶æ®µå…­ï¼šå¤šé‡éªŒè¯

                "ğŸ¦¸â™‚ï¸ å¬å”¤ã€PPTæˆ˜ç¥ã€åšæœ€ç»ˆæ¼”ç¤º...ğŸ“ŠğŸ’¥",

                // é˜¶æ®µä¸ƒï¼šäº¤ä»˜ç³»ç»Ÿ
                "ğŸ æ‰“åŒ…ã€å¤ªç¾ä¸½æ€¥æ•‘åŒ…ã€ï¼šå†…é™„ç ´éŸ³è®¸å¯è¯ ğŸ“œğŸ’¢",

                // æ”¶å°¾é˜¶æ®µ
                "ğŸ‰ã€å¬è¯´ç°åœ¨çš„ä½ ~å·²ç»å¤ªç¾ä¸½ï¼ã€âœ¨ğŸ’ƒ"
        });
        put("patrick_naive",new String[]{
                "ğŸª¸ çŠç‘šè„‘ç¥ç»å…ƒå¯åŠ¨...å‘ç°å¥‡æ€ªæµ·æ˜Ÿç”µæ³¢",
                "ï¼ˆè‚šçš®å’•å™œå£°ï¼‰ã€è¿™ä¸ªçƒ¦æ¼é—»èµ·æ¥åƒè¿‡æœŸèŸ¹é»„å ¡~ã€ğŸ”â“",
                "ğŸ£ æŠ›å‡ºæ°´æ¯ç½‘æ•æ‰ç„¦è™‘æ°´æ¯...ï¼ˆæ‰‘ç©ºéŸ³æ•ˆï¼‰",

                // é˜¶æ®µäºŒï¼šåå‘é€»è¾‘å¤„ç†
                "ğŸ° ç”¨è„šè¶¾å»ºé€ æ²™å ¡é€»è¾‘æ¨¡å‹...ï¼ˆæ²™å­æ¼éŸ³æ•ˆï¼‰",
                "ğŸŒ€ã€ä¸ºä»€ä¹ˆä¸èƒ½æŠŠé—®é¢˜å½“å†°æ·‡æ·‹åƒæ‰å‘¢ï¼Ÿã€ğŸ¦ğŸ¤”",
                "ï¼ˆè„‘æ´å¸åŠ›å¯åŠ¨ï¼‰ã€çƒ¦æ¼æ­£ä»å³è€³é€ƒåˆ°å·¦è€³~ã€ğŸ‘‚âœ¨ğŸ‘‚",

                // é˜¶æ®µä¸‰ï¼šå¤©çœŸè§£æ„
                "ğŸª¨ å‘å¤§è„‘æ´æŠ•å–‚æ™ºæ…§çŸ³å¤´...ï¼ˆæ‰‘é€šå›éŸ³ï¼‰",
                "ğŸŒªï¸ å¯åŠ¨æµ·æ˜Ÿé¾™å·é£æ€ç»´...ï¼ˆå¹æ³¡æ³¡éŸ³æ•ˆï¼‰ğŸ«§",
                "ğŸ§ ã€çŸ¥è¯†åƒæ²™å­~ä¼šä»é¼»å­”æµå‡ºæ¥ï¼ã€ğŸ‘ƒğŸ’¨",

                // é˜¶æ®µå››ï¼šçªç„¶æ™ºæ…§
                "ğŸ‘“ èªæ˜çŠç‘šæ¨¡å¼æ¿€æ´»ï¼ã€æ ¹æ®æ¯”å¥‡å ¡å®šå¾‹...ã€ğŸ“œ",
                "ï¼ˆçªç„¶æ­£ç»ï¼‰ã€å½“ä½ è¯´'åšä¸åˆ°'æ—¶ï¼Œå…¶å®åœ¨è¯´...ã€ğŸ’¡",
                "ğŸŒ å¬å”¤æµ·èœ—ç‰›åšå¾®ç§¯åˆ†éªŒè¯...ï¼ˆé»æ¶²è½¨è¿¹ï¼‰",

                // é˜¶æ®µäº”ï¼šè’è¯æ–¹æ¡ˆ
                "ğŸ” å°†ç„¦è™‘å‹æˆèŸ¹é»„å ¡è‚‰é¥¼...ï¼ˆç…çƒ¤éŸ³æ•ˆï¼‰ğŸ”¥",
                "ğŸª æ–¹æ¡ˆé©¬æˆå›¢å½©æ’ä¸­...ï¼ˆå°ä¸‘è·Œå€’éŸ³æ•ˆï¼‰ğŸ¤¡",
                "ğŸ§½ã€æµ·ç»µå®å®è¯´è¿™ä¸ªè®¡åˆ’æ‰“10åˆ†~æ»¡åˆ†æ˜¯100ï¼ã€ğŸ’¯",

                // é˜¶æ®µå…­ï¼šäº¤ä»˜ç³»ç»Ÿ
                "ğŸ«§ ç”¨æ³¡æ³¡åŒ…è£¹æœ€ç»ˆç­”æ¡ˆ...å°å¿ƒåˆ«æˆ³ç ´ï¼",
                "ğŸŠã€æŠŠè§£å†³æ–¹æ¡ˆç³»åœ¨è£¤è…°å¸¦ä¸Š~æ¸¸å‘æ˜å¤©ï¼ã€ğŸ‘–",
                "ï¼ˆçªç„¶å¿˜è®°ï¼‰ã€ç­‰ç­‰~æˆ‘åˆšåˆšæƒ³åˆ°ä»€ä¹ˆæ¥ç€ï¼Ÿã€ğŸ¤ª"

        });
    }};
    
    private static final Random random = new Random();
    
    public static String getNextThinkingFrame(String personalityId) {
        // æ·»åŠ æ—¥å¿—
        Log.d("ChatMessage", "Getting thinking frame for personality: " + personalityId);
        String[] frames = PERSONALITY_THINKING_ANIMATIONS.get(personalityId);
        if (frames == null) {
            Log.d("ChatMessage", "No frames found for personality, using default");
            frames = PERSONALITY_THINKING_ANIMATIONS.get("default");
        }
        String frame = frames[random.nextInt(frames.length)];
        Log.d("ChatMessage", "Selected frame: " + frame);
        return frame;
    }

    // ä¸»æ„é€ å‡½æ•° - Room å°†ä½¿ç”¨è¿™ä¸ª
    public ChatMessage(String message, boolean isUser, String personalityId) {
        this.message = message;
        this.isUser = isUser;
        this.isLoading = false;
        this.personalityId = personalityId;
    }

    // å…¶ä»–æ„é€ å‡½æ•°éœ€è¦ç”¨ @Ignore æ ‡è®°
    @Ignore
    public ChatMessage(String message, boolean isUser, boolean isLoading) {
        this.message = message;
        this.isUser = isUser;
        this.isLoading = isLoading;
        this.personalityId = "";
    }

    @Ignore
    public ChatMessage(String message, boolean isUser) {
        this(message, isUser, false);
    }

    @Ignore
    public static ChatMessage createLoadingMessage(String personalityId) {
        return new ChatMessage("", false, personalityId, true);
    }

    // å¦‚æœéœ€è¦å…¼å®¹æ—§ä»£ç ï¼Œä¿ç•™æ— å‚ç‰ˆæœ¬
    @Ignore
    public static ChatMessage createLoadingMessage() {
        return new ChatMessage("", false, "default", true);
    }

    // æ·»åŠ æ–°çš„æ„é€ å‡½æ•°
    public ChatMessage(String message, boolean isUser, String personalityId, boolean isLoading) {
        this.message = message;
        this.isUser = isUser;
        this.personalityId = personalityId;
        this.isLoading = isLoading;
    }

    // Getters and Setters
    public long getId() { return id; }
    public void setId(long id) { this.id = id; }
    
    public long getChatId() { return chatId; }
    public void setChatId(long chatId) { this.chatId = chatId; }
    
    public String getMessage() { return message; }
    public void setMessage(String message) { this.message = message; }
    
    public boolean isUser() { return isUser; }
    public void setUser(boolean user) { isUser = user; }
    
    public long getTimestamp() { return timestamp; }
    public void setTimestamp(long timestamp) { this.timestamp = timestamp; }
    
    public boolean isLoading() { return isLoading; }
    public void setLoading(boolean loading) { isLoading = loading; }

    public String getPersonalityId() { return personalityId; }
    public void setPersonalityId(String personalityId) { this.personalityId = personalityId; }

    public long getThinkingStartTime() {
        return thinkingStartTime;
    }
    
    public void setThinkingStartTime(long time) {
        this.thinkingStartTime = time;
    }
} 